<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Birth Pulse - Cinematic TV Pro V90</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body, html {
            margin: 0; padding: 0; width: 100vw; height: 100vh;
            overflow: hidden; background-color: #000000;
            font-family: Arial, Helvetica, sans-serif; color: white;
            cursor: grab; touch-action: none;
        }
        body:active { cursor: grabbing; }

        /* 1. SCHEDULER & SLEEP OVERLAYS */
        #web-overlay { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: white; z-index: 5000; display: none; }
        iframe { width: 100%; height: 100%; border: none; }
        #sleep-overlay { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: #000000; z-index: 9999; display: none; }
        
        #quiz-overlay {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background: rgba(0,0,0,0.95); z-index: 2000; display: none;
            align-items: center; justify-content: center; pointer-events: auto;
        }
        .quiz-card { background: rgba(15, 23, 42, 0.98); border: 2px solid #a855f7; padding: 40px; border-radius: 20px; width: 65vw; text-align: center; }
        .option-btn { display: block; width: 100%; padding: 12px; margin: 10px 0; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.2); border-radius: 10px; font-size: 1.4vw; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .option-btn:hover { background: #0b5ed7; border-color: white; }

        /* 2. KNOWLEDGE BUTTON */
        .knowledge-btn {
            position: absolute; bottom: 5vh; right: 5vw; z-index: 1000;
            padding: 15px 30px; background: rgba(109, 40, 217, 0.5);
            border: 2px solid #fbbf24; border-radius: 50px; color: white;
            font-weight: 800; font-size: 1.2vw; text-transform: uppercase;
            letter-spacing: 2px; cursor: pointer; pointer-events: auto;
            animation: btn-pulse 2.5s infinite;
        }
        @keyframes btn-pulse { 0%, 100% { box-shadow: 0 0 15px rgba(168, 85, 247, 0.4); } 50% { box-shadow: 0 0 30px rgba(251, 191, 36, 0.5); } }

        /* 3. LEFT-ALIGNED UI ROOT */
        .ui-root {
            position: absolute; left: 4vw; top: 5vh; bottom: 5vh;
            width: 45vw; z-index: 100; pointer-events: none;
            display: flex; flex-direction: column;
            justify-content: flex-start; /* Stack from top */
            align-items: flex-start; /* Align all left */
        }

        .header-box { pointer-events: auto; margin-bottom: 6vh; }
        .philips-title { font-size: 2.8vw; font-weight: 900; color: #0b5ed7; letter-spacing: -0.05vw; margin-bottom: 10px; text-transform: uppercase; }
        
        .main-heading { font-size: 3.1vw; color: #a855f7; font-weight: 800; white-space: nowrap; }
        .main-heading span { display: inline-block; transition: all 0.5s ease; }
        
        @keyframes wordPulse {
            0%, 20%, 100% { transform: scale(1); color: #a855f7; text-shadow: 0 0 20px rgba(168, 85, 247, 0.4); }
            10% { transform: scale(1.15); color: #fbbf24; text-shadow: 0 0 30px rgba(251, 191, 36, 0.6); }
        }
        @keyframes ampAlwaysRotate { from { transform: rotateY(0deg); } to { transform: rotateY(360deg); } }

        .w1 { animation: wordPulse 3s infinite 0.0s; }
        .w_amp { animation: ampAlwaysRotate 3s linear infinite !important; color: #fbbf24; margin: 0 0.5vw; }
        .w2 { animation: wordPulse 3s infinite 0.6s; }
        .w3 { animation: wordPulse 3s infinite 1.2s; }
        .w4 { animation: wordPulse 3s infinite 1.8s; }
        .w5 { animation: wordPulse 3s infinite 2.4s; }

        /* STATS PANEL BELOW HEADER */
        .stats-box { pointer-events: auto; width: 100%; margin-top: 2vh; }
        .label { font-size: 1.6vw; color: #38bdf8; text-transform: uppercase; font-weight: 900; letter-spacing: 3px; }
        .count { font-size: 8.5vw; font-weight: 900; color: #fbbf24; line-height: 1; margin: 10px 0; }
        
        .progress-ui { width: 90%; margin-top: 20px; }
        .bar-wrapper { width: 100%; height: 16px; background: rgba(255,255,255,0.05); border-radius: 20px; overflow: hidden; margin-top: 10px; }
        .bar-fill { height: 100%; width: 0%; background: #fbbf24; }
        #clock { color: #fbbf24; font-size: 1.8vw; font-weight: bold; display: block; text-align: center; margin-top: 15px; }

        /* 4. CANVAS & GLOBE */
        .stars-container { position: absolute; width: 100%; height: 100%; z-index: 1; pointer-events: none; }
        .star { position: absolute; background: white; border-radius: 50%; animation: blink var(--t) infinite ease-in-out; }
        @keyframes blink { 0%, 100% { opacity: 0.1; transform: scale(0.8); } 50% { opacity: 0.8; } }
        .canvas-container { position: absolute; left: 0; top: 0; width: 100vw; height: 100vh; z-index: 10; pointer-events: none; }
        #main-canvas { width: 100%; height: 100%; }

        #loading { position: absolute; width: 100%; height: 100%; background: #000000; display: flex; align-items: center; justify-content: center; z-index: 2000; color: #38bdf8; font-size: 2.5vw; }
    </style>
</head>
<body>

    <div id="loading">REALIGNING CINEMATIC INTERFACE...</div>
    
    <div id="web-overlay">
        <iframe src="https://engage.cloud.microsoft/main/org/philips.onmicrosoft.com/groups/eyJfdHlwZSI6Ikdyb3VwIiwiaWQiOiIxODgzNTUzNzkzIn0"></iframe>
    </div>
    <div id="sleep-overlay"></div>
    
    <div id="quiz-overlay">
        <div class="quiz-card">
            <h2 id="quiz-question" class="text-3xl font-bold mb-8 text-white">Question</h2>
            <div id="quiz-options"></div>
            <div id="quiz-feedback" class="mt-4"></div>
        </div>
    </div>

    <button class="knowledge-btn" onclick="openQuiz()">Press here for some knowledge check</button>

    <div class="ui-root">
        <div class="header-box">
            <div class="philips-title">PHILIPS</div>
            <h1 class="main-heading">
                <span class="w1">Mother</span> 
                <span class="w_amp">&</span> 
                <span class="w2">Child</span> 
                <span class="w3">Care</span> ‚Äî 
                <span class="w4">Women's</span> 
                <span class="w5">Health</span>
            </h1>
        </div>

        <div class="stats-box">
            <span class="label">Global Birth Count Today</span>
            <div id="birthCount" class="count">0</div>
            <div class="progress-ui">
                <div class="flex justify-between w-[100%] mb-1 px-1">
                    <span class="text-cyan-400 font-bold text-[1.1vw]">00:00</span>
                    <span class="text-cyan-400 font-bold text-[1.1vw]">24:00</span>
                </div>
                <div class="bar-wrapper"><div id="bar" class="bar-fill"></div></div>
                <span id="clock">00:00:00</span>
            </div>
        </div>
    </div>

    <div class="stars-container" id="starfield"></div>
    <div class="canvas-container"><canvas id="main-canvas"></canvas></div>

    <script>
        // --- TV-SAFE ES5 SCRIPT ---
        var BIRTH_RATE = 4.34, EARTH_ROT_SPD = 0.008, RESUME_DELAY = 5000, TARGET_TILT = -15;

        function runSchedule() {
            var date = new Date(), mins = date.getMinutes(), hours = date.getHours();
            var webView = document.getElementById('web-overlay');
            var sleepView = document.getElementById('sleep-overlay');
            if (hours >= 20 || hours < 6) { sleepView.style.display = 'block'; webView.style.display = 'none'; return; }
            else { sleepView.style.display = 'none'; }
            if (mins < 5) { webView.style.display = 'block'; } 
            else { webView.style.display = 'none'; }
        }
        setInterval(runSchedule, 10000);

        // --- QUIZ DATA ---
        var quizData = [
            { q: "In which year was Philips founded?", o: ["1885", "1891", "1905", "1912"], a: 1 },
            { q: "Who founded Philips?", o: ["Gerard & Frederik", "Anton & Gerard", "Willem & Anton", "Gerard & Siemens"], a: 1 },
            { q: "Philips aims to improve how many lives by 2030?", o: ["100m", "500m", "1 billion", "5 billion"], a: 2 }
        ];

        function openQuiz() {
            var overlay = document.getElementById('quiz-overlay'), qText = document.getElementById('quiz-question'), oBox = document.getElementById('quiz-options'), fBox = document.getElementById('quiz-feedback');
            fBox.innerText = ""; oBox.innerHTML = ""; overlay.style.display = "flex";
            var qObj = quizData[Math.floor(Math.random() * quizData.length)];
            qText.innerText = qObj.q;
            for(var i=0; i<qObj.o.length; i++){
                var btn = document.createElement('button');
                btn.className = "option-btn"; btn.innerText = String.fromCharCode(65 + i) + ". " + qObj.o[i];
                btn.onclick = (function(idx, correct, correctText) {
                    return function() {
                        if (idx === correct) { fBox.innerHTML = "<span style='color:#4ade80'>üëç Thumbs Up!</span>"; } 
                        else { fBox.innerHTML = "<span style='color:#f43f5e'>Better luck next time.</span><br><span style='color:white; font-size:1.5vw; font-weight:normal;'>Correct: " + correctText + "</span>"; }
                        setTimeout(function(){ overlay.style.display = "none"; }, 4000);
                    };
                })(i, qObj.a, qObj.o[qObj.a]);
                oBox.appendChild(btn);
            }
        }

        // --- PHYSICS ENGINE ---
        var moon = { d:380, sz:60, spd:0.0012, ang:Math.random()*7, col:"#f0f9ff", craters:[] };
        for(var i=0; i<20; i++) moon.craters.push({x:(Math.random()-0.5)*100, y:(Math.random()-0.5)*100, r:Math.random()*5+1, op:Math.random()*0.3});
        var saturn = { d:650, sz:32, spd:0.0002, ang:Math.random()*7, col:"#d8ae8d" };
        var planets = [{id:'mer',d:130,sz:6,spd:0.0008,col:"#A5A5A5",ang:Math.random()*7},{id:'jup',d:530,sz:28,spd:0.0003,col:"#c3a48e",ang:Math.random()*7}];
        var worldGeo = null, featureIndex = {}, flashingISO = {}, comets = [];
        var canvas = document.getElementById("main-canvas"), context = canvas.getContext("2d");
        var w, h, isDragging = false, lastX, lastY, rotX = 0, rotY = TARGET_TILT, lastT = Date.now(), lastIntT = Date.now();

        function setSizes() { w = window.innerWidth; h = window.innerHeight; canvas.width = w; canvas.height = h; }
        setSizes();
        var projection = d3.geoOrthographic().scale(h/2.8).translate([w*0.74, h*0.5]).clipAngle(90);
        var path = d3.geoPath(projection, context);

        function startDrag(x,y){isDragging=true; lastX=x; lastY=y; lastIntT=Date.now();}
        function moveDrag(x,y){if(isDragging){rotX+=(x-lastX)*0.3; rotY-=(y-lastY)*0.3; lastX=x; lastY=y; lastIntT=Date.now();}}
        window.addEventListener('mousedown',function(e){startDrag(e.clientX,e.clientY);});
        window.addEventListener('mousemove',function(e){moveDrag(e.clientX,e.clientY);});
        window.addEventListener('mouseup',function(){isDragging=false;});
        window.addEventListener('touchstart',function(e){if(e.touches.length>0){e.preventDefault(); startDrag(e.touches[0].clientX,e.touches[0].clientY);}},{passive:false});
        window.addEventListener('touchmove',function(e){if(e.touches.length>0){e.preventDefault(); moveDrag(e.touches[0].clientX,e.touches[0].clientY);}},{passive:false});

        function init() {
            d3.json("https://raw.githubusercontent.com/nvkelso/natural-earth-vector/master/geojson/ne_110m_admin_0_countries.geojson").then(function(data) {
                worldGeo = data;
                for(var i=0; i<data.features.length; i++){ var f = data.features[i]; featureIndex[f.properties.ISO_A3 || f.properties.ADM0_A3] = f; }
                document.getElementById('loading').style.display='none';
                runSchedule(); requestAnimationFrame(renderLoop); startSimulation();
            });
        }

        function renderLoop() {
            var now = Date.now(), dt = now - lastT; lastT = now;
            if(!isDragging && (now - lastIntT > RESUME_DELAY)){
                rotX += EARTH_ROT_SPD * dt;
                if(Math.abs(rotY - TARGET_TILT) > 0.1) rotY += (TARGET_TILT - rotY)*0.02; else rotY = TARGET_TILT;
            }
            projection.rotate([rotX, rotY]);
            context.clearRect(0,0,w,h);
            var ex=w*0.74, ey=h*0.5;
            var sAng = now * 0.00003, sx = ex + Math.cos(sAng)*(w*0.55), sy = ey + Math.sin(sAng)*(h*0.4);
            var sGrad = context.createRadialGradient(sx,sy,0,sx,sy,60);
            sGrad.addColorStop(0,"#ffffff"); sGrad.addColorStop(0.3,"#fbbf24"); sGrad.addColorStop(1,"transparent");
            context.beginPath(); context.arc(sx,sy,60,0,7); context.fillStyle=sGrad; context.fill();
            drawMoon(moon, ex, ey, sx, sy, dt);
            drawSaturn(saturn, ex, ey, sx, sy, dt);
            for(var i=0; i<planets.length; i++) drawPlanet(planets[i], ex, ey, sx, sy, dt);
            var center = projection.translate(), radius = projection.scale();
            var oceanGrad = context.createRadialGradient(center[0]-radius/2.5, center[1]-radius/2.5, radius/20, center[0], center[1], radius);
            oceanGrad.addColorStop(0, "#3b82f6"); oceanGrad.addColorStop(0.5, "#0a192f"); oceanGrad.addColorStop(1, "#020617");
            context.beginPath(); context.arc(center[0], center[1], radius, 0, 7); context.fillStyle = oceanGrad; context.fill();
            if (worldGeo) {
                context.beginPath(); path(worldGeo); context.fillStyle = "#10b981"; context.fill();
                context.strokeStyle = "rgba(255,255,255,0.3)"; context.lineWidth = 0.6; context.stroke();
                for (var iso in flashingISO) {
                    if (now - flashingISO[iso] < 1500) {
                        var feat = featureIndex[iso];
                        if(feat) { context.beginPath(); path(feat); context.fillStyle="#ffffff"; context.fill(); context.strokeStyle="white"; context.stroke(); }
                    } else { delete flashingISO[iso]; }
                }
            }
            updateComets();
            requestAnimationFrame(renderLoop);
        }

        function drawMoon(p, ex, ey, sx, sy, dt) {
            p.ang += p.spd*dt*0.1; var px=ex+Math.cos(p.ang)*p.d, py=ey+Math.sin(p.ang)*p.d*0.7;
            var dx=px-sx, dy=py-sy, ang=Math.atan2(dy,dx);
            context.save(); context.translate(px,py);
            context.shadowBlur = 50; context.shadowColor = "#3b82f6";
            var g = context.createRadialGradient(0, 0, 0, 0, 0, p.sz);
            g.addColorStop(0, "#ffffff"); g.addColorStop(0.6, "#dbeafe"); g.addColorStop(1, "#93c5fd");
            context.beginPath(); context.arc(0, 0, p.sz, 0, 7); context.fillStyle = g; context.fill();
            context.clip(); context.fillStyle = "rgba(147, 197, 253, 0.3)";
            for(var i=0; i<8; i++) { context.beginPath(); context.ellipse(Math.sin(i)*15, Math.cos(i)*10, 20, 12, i, 0, 7); context.fill(); }
            context.restore();
            var shad = context.createRadialGradient(px + Math.cos(ang)*p.sz*0.5, py + Math.sin(ang)*p.sz*0.5, 0, px, py, p.sz);
            shad.addColorStop(0, "rgba(0,0,0,0)"); shad.addColorStop(1, "rgba(0,0,0,0.95)");
            context.beginPath(); context.arc(px, py, p.sz + 0.5, 0, 7); context.fillStyle = shad; context.fill();
        }

        function drawSaturn(p,ex,ey,sx,sy,dt){
            p.ang += p.spd*dt*0.1; var px=ex+Math.cos(p.ang)*p.d, py=ey+Math.sin(p.ang)*p.d*0.65;
            var dx=px-sx, dy=py-sy, ang=Math.atan2(dy,dx);
            context.save(); context.translate(px,py);
            context.globalAlpha=0.6; for(var r=0;r<10;r++){ context.beginPath(); context.ellipse(0,0,p.sz*(1.8+r*0.1),p.sz*(0.6+r*0.03),0.4,0,7); context.strokeStyle="rgba(216, 174, 141, 0.2)"; context.stroke(); }
            context.globalAlpha=1; var g=context.createRadialGradient(-p.sz*0.3,-p.sz*0.3,0,0,0,p.sz); g.addColorStop(0,p.col); g.addColorStop(1,"#1a0f08");
            context.beginPath(); context.arc(0,0,p.sz,0,7); context.fillStyle=g; context.fill();
            context.restore();
            var shad=context.createRadialGradient(px+Math.cos(ang)*p.sz*0.5, py+Math.sin(ang)*p.sz*0.5, 0, px,py,p.sz);
            shad.addColorStop(0,"rgba(0,0,0,0)"); shad.addColorStop(1,"rgba(0,0,0,0.9)");
            context.beginPath(); context.arc(px,py,p.sz+0.5,0,7); context.fillStyle=shad; context.fill();
        }

        function drawPlanet(p,ex,ey,sx,sy,dt){
            p.ang += p.spd*dt*0.1; var px=ex+Math.cos(p.ang)*p.d, py=ey+Math.sin(p.ang)*p.d*0.7;
            var dx=px-sx, dy=py-sy, ang=Math.atan2(dy,dx);
            context.save(); context.translate(px,py);
            var g=context.createRadialGradient(-p.sz*0.3,-p.sz*0.3,0,0,0,p.sz); g.addColorStop(0,p.col); g.addColorStop(1,"#000");
            context.beginPath(); context.arc(0,0,p.sz,0,7); context.fillStyle=g; context.fill();
            context.restore();
            var shad=context.createRadialGradient(px+Math.cos(ang)*p.sz*0.5, py+Math.sin(ang)*p.sz*0.5, 0, px,py,p.sz);
            shad.addColorStop(0,"rgba(0,0,0,0)"); shad.addColorStop(1,"rgba(0,0,0,0.9)");
            context.beginPath(); context.arc(px,py,p.sz+0.5,0,7); context.fillStyle=shad; context.fill();
        }

        function updateComets() {
            if (Math.random() > 0.996) comets.push({ x:Math.random()*w, y:-50, vx:-14, vy:10, life:1 });
            for (var i=0; i<comets.length; i++) {
                var c = comets[i]; var g = context.createLinearGradient(c.x,c.y,c.x-c.vx*12,c.y-c.vy*12);
                g.addColorStop(0,"white"); g.addColorStop(1,"transparent");
                context.strokeStyle=g; context.lineWidth=4; context.beginPath(); context.moveTo(c.x,c.y); context.lineTo(c.x+120,c.y-100); context.stroke();
                c.x+=c.vx; c.y+=c.vy; c.life-=0.008; if(c.life<=0){ comets.splice(i,1); i--; }
            }
        }

        function startSimulation() {
            setInterval(function() {
                var now = new Date(), start = new Date(now.getFullYear(), now.getMonth(), now.getDate()).getTime();
                var elapsed = (Date.now() - start) / 1000;
                document.getElementById('birthCount').innerText = Math.floor(elapsed * BIRTH_RATE).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
                document.getElementById('clock').innerText = now.toLocaleTimeString('en-GB');
                document.getElementById('bar').style.width = (elapsed / 86400 * 100) + "%";
                if (worldGeo) {
                    var keys = Object.keys(featureIndex); flashingISO[keys[Math.floor(Math.random()*keys.length)]] = Date.now();
                }
            }, 1000 / BIRTH_RATE);
        }

        var field = document.getElementById('starfield');
        for (var i = 0; i < 70; i++) {
            var s = document.createElement('div'); s.className = 'star';
            s.style.width = s.style.height = (1 + Math.random()*2) + 'px';
            s.style.left = Math.random()*100 + '%'; s.style.top = Math.random()*100 + '%';
            s.style.setProperty('--t', (2 + Math.random()*3) + 's');
            field.appendChild(s);
        }
        window.onresize = setSizes; init();
    </script>
</body>
</html>