<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Birth Pulse - Cinematic TV Pro V78</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body, html {
            margin: 0; padding: 0; width: 100vw; height: 100vh;
            overflow: hidden; background-color: #000000;
            font-family: Arial, Helvetica, sans-serif; color: white;
            cursor: grab; touch-action: none;
        }
        body:active { cursor: grabbing; }

        /* 1. SLEEP MODE OVERLAY */
        #sleep-overlay {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background: #000000; z-index: 9999; display: none;
        }

        /* 2. BACKGROUND STARS */
        .stars-container {
            position: absolute; width: 100%; height: 100%;
            z-index: 1; pointer-events: none;
        }
        .star {
            position: absolute; background: white; border-radius: 50%;
            animation: blink var(--t) infinite ease-in-out;
        }
        @keyframes blink { 0%, 100% { opacity: 0.1; transform: scale(0.8); } 50% { opacity: 0.8; } }

        /* 3. PHILIPS LOGO & HEADER */
        .header-box {
            position: absolute; top: 5vh; left: 5vw;
            z-index: 500; text-align: left;
        }
        .philips-logo-static { display: flex; margin-bottom: 5px; }
        .philips-logo-static span {
            font-size: 2.8vw; font-weight: 900; letter-spacing: -0.05vw;
            color: #0b5ed7; text-transform: uppercase;
        }
        .main-heading {
            font-size: 3.1vw; color: #a855f7; font-weight: 800; 
            text-shadow: 0 0 30px rgba(168, 85, 247, 0.4); white-space: nowrap;
        }

        /* 4. STATS PANEL */
        .stats-box { 
            position: absolute; bottom: 8vh; left: 5vw; 
            width: 38vw; z-index: 100; text-align: left;
        }
        .label { font-size: 1.8vw; color: #38bdf8; text-transform: uppercase; font-weight: 900; letter-spacing: 3px; }
        .count { font-size: 8.5vw; font-weight: 900; color: #fbbf24; line-height: 1.1; margin: 5px 0; }
        
        .progress-ui { width: 90%; margin-top: 10px; }
        .time-labels { display: flex; justify-content: space-between; width: 100%; margin-bottom: 4px; }
        .marker-text { color: #38bdf8; font-size: 1.2vw; font-weight: bold; opacity: 0.8; }
        .bar-wrapper { width: 100%; height: 14px; background: rgba(255,255,255,0.05); border-radius: 20px; overflow: hidden; }
        .bar-fill { height: 100%; width: 0%; background: #fbbf24; }
        #clock { color: #fbbf24; font-size: 1.8vw; font-weight: bold; display: block; text-align: center; margin-top: 12px; letter-spacing: 2px;}

        /* 5. CANVAS CONTAINER */
        .canvas-container { position: absolute; left: 0; top: 0; width: 100vw; height: 100vh; z-index: 5; }
        #main-canvas { width: 100%; height: 100%; }

        #loading {
            position: absolute; width: 100%; height: 100%;
            background: #000000; display: flex; align-items: center; 
            justify-content: center; z-index: 2000; color: #38bdf8; font-size: 2.5vw;
        }
    </style>
</head>
<body>

    <div id="loading">OPTIMIZING AUTO-ROTATION ENGINE...</div>
    <div id="sleep-overlay"></div>
    
    <div class="header-box">
        <div class="philips-logo-static">
            <span>P</span><span>H</span><span>I</span><span>L</span><span>I</span><span>P</span><span>S</span>
        </div>
        <h1 class="main-heading">Mother & Child Care-Women's Health</h1>
    </div>

    <div class="stats-box">
        <span class="label">Global Birth Count Today</span>
        <div id="birthCount" class="count">0</div>
        <div class="progress-ui">
            <div class="time-labels"><span class="marker-text">00:00</span><span class="marker-text">24:00</span></div>
            <div class="bar-wrapper"><div id="bar" class="bar-fill"></div></div>
            <span id="clock">00:00:00</span>
        </div>
    </div>

    <div class="stars-container" id="starfield"></div>
    <div class="canvas-container"><canvas id="main-canvas"></canvas></div>

    <script>
        // TV-SAFE ES5 SCRIPT
        var BIRTH_RATE = 4.34;
        var EARTH_ROT_SPD = 0.008; 
        var RESUME_DELAY = 5000;
        var TARGET_TILT = -15;
        
        var globeThemes = [
            { land: "#10b981", flash: "#ffffff", ocean: "#0a192f" },
            { land: "#fb7185", flash: "#ffffff", ocean: "#1e0108" },
            { land: "#0ea5e9", flash: "#fbbf24", ocean: "#082f49" },
            { land: "#eab308", flash: "#a855f7", ocean: "#1e0a01" }
        ];
        var currentThemeIdx = 0;

        // HI-RES PROCEDURAL PLANET DATA
        var moon = { dist: 380, sz: 60, spd: 0.0012, ang: Math.random()*7, col: "#cbd5e1" };
        var saturn = { dist: 650, sz: 32, spd: 0.0002, ang: Math.random()*7, col: "#d8ae8d" };
        var planets = [
            { id: 'mer', dist: 130, sz: 6, spd: 0.0008, col: "#A5A5A5", ang: Math.random()*7 },
            { id: 'jup', dist: 530, sz: 28, spd: 0.0003, col: "#c3a48e", ang: Math.random()*7 }
        ];
        
        var worldGeo = null, featureIndex = {}, flashingISO = {}, comets = []; 
        var canvas = document.getElementById("main-canvas");
        var context = canvas.getContext("2d");
        var w, h, isDragging = false, lastX, lastY, rotX = 0, rotY = TARGET_TILT, lastT = Date.now(), lastInteractionT = Date.now();

        function setSizes() { w = window.innerWidth; h = window.innerHeight; canvas.width = w; canvas.height = h; }
        setSizes();

        var projection = d3.geoOrthographic().scale(h / 2.8).translate([w * 0.74, h * 0.5]).clipAngle(90);
        var path = d3.geoPath(projection, context);

        // Interaction Handlers
        function onAction() { lastInteractionT = Date.now(); }
        function hStart(x, y) { isDragging = true; lastX = x; lastY = y; onAction(); }
        function hMove(x, y) { if (isDragging) { rotX += (x - lastX)*0.3; rotY -= (y - lastY)*0.3; lastX = x; lastY = y; onAction(); } }
        function hEnd() { isDragging = false; onAction(); }

        canvas.addEventListener('mousedown', function(e) { hStart(e.clientX, e.clientY); });
        window.addEventListener('mousemove', function(e) { hMove(e.clientX, e.clientY); });
        window.addEventListener('mouseup', hEnd);
        canvas.addEventListener('touchstart', function(e) { e.preventDefault(); hStart(e.touches[0].clientX, e.touches[0].clientY); }, {passive: false});
        window.addEventListener('touchmove', function(e) { e.preventDefault(); hMove(e.touches[0].clientX, e.touches[0].clientY); }, {passive: false});
        window.addEventListener('touchend', hEnd);

        setInterval(function() { currentThemeIdx = (currentThemeIdx + 1) % globeThemes.length; }, 180000);

        function checkSleepMode() {
            var hr = new Date().getHours();
            document.getElementById('sleep-overlay').style.display = (hr >= 20 || hr < 6) ? 'block' : 'none';
        }
        setInterval(checkSleepMode, 30000);

        function init() {
            d3.json("https://raw.githubusercontent.com/nvkelso/natural-earth-vector/master/geojson/ne_110m_admin_0_countries.geojson").then(function(data) {
                worldGeo = data;
                for(var i=0; i<data.features.length; i++) {
                    var f = data.features[i];
                    featureIndex[f.properties.ISO_A3 || f.properties.ADM0_A3] = f;
                }
                document.getElementById('loading').style.display = 'none';
                checkSleepMode();
                requestAnimationFrame(renderLoop);
                startSimulation();
            });
        }

        function renderLoop() {
            var now = Date.now();
            var dt = now - lastT;
            lastT = now;
            
            // --- AUTO RESUME ENGINE ---
            if (!isDragging) {
                if (now - lastInteractionT > RESUME_DELAY) {
                    rotX += EARTH_ROT_SPD * dt;
                    // Vertical Realignment logic
                    if (Math.abs(rotY - TARGET_TILT) > 0.1) {
                        rotY += (TARGET_TILT - rotY) * 0.02;
                    } else {
                        rotY = TARGET_TILT;
                    }
                }
            }

            projection.rotate([rotX, rotY]);
            context.clearRect(0, 0, w, h);
            var ex = w * 0.74, ey = h * 0.5;

            updateComets();

            // 1. Draw Sun
            var sAng = now * 0.00003;
            var sx = ex + Math.cos(sAng) * (w * 0.55);
            var sy = ey + Math.sin(sAng) * (h * 0.4);
            var sGrad = context.createRadialGradient(sx, sy, 0, sx, sy, 60);
            sGrad.addColorStop(0, "#ffffff"); sGrad.addColorStop(0.3, "#fbbf24"); sGrad.addColorStop(1, "transparent");
            context.beginPath(); context.arc(sx, sy, 60, 0, 7); context.fillStyle = sGrad; context.fill();

            // 2. Draw High-Detail Saturn
            drawRealisticSaturn(sx, sy, ex, ey, dt, now);

            // 3. Draw Photorealistic Moon
            drawPhotorealisticMoon(sx, sy, ex, ey, dt, now);

            // 4. Draw Other Planets
            for(var i=0; i<planets.length; i++) drawPlanet(planets[i], ex, ey, sx, sy, dt, now);

            // 5. Draw Earth
            var center = projection.translate(), radius = projection.scale(), theme = globeThemes[currentThemeIdx];
            var oceanGrad = context.createRadialGradient(center[0]-radius/2.5, center[1]-radius/2.5, radius/20, center[0], center[1], radius);
            oceanGrad.addColorStop(0, "#3b82f6"); oceanGrad.addColorStop(0.5, theme.ocean); oceanGrad.addColorStop(1, "#020617");
            context.beginPath(); context.arc(center[0], center[1], radius, 0, 7);
            context.fillStyle = oceanGrad; context.fill();

            if (worldGeo) {
                context.beginPath(); path(worldGeo); 
                context.fillStyle = theme.land; context.fill();
                context.strokeStyle = "rgba(255, 255, 255, 0.3)"; context.lineWidth = 0.6; context.stroke();
                for (var iso in flashingISO) {
                    if (now - flashingISO[iso] < 1500) {
                        var feat = featureIndex[iso];
                        if(feat) {
                            context.beginPath(); path(feat);
                            context.fillStyle = theme.flash; context.fill();
                            context.strokeStyle = "white"; context.lineWidth = 1.2; context.stroke();
                        }
                    } else { delete flashingISO[iso]; }
                }
            }
            requestAnimationFrame(renderLoop);
        }

        function drawPhotorealisticMoon(sx, sy, ex, ey, dt, t) {
            moon.ang += moon.spd * dt * 0.1;
            var px = ex + Math.cos(moon.ang) * moon.dist;
            var py = ey + Math.sin(moon.ang) * moon.dist * 0.7;
            var dx = px - sx, dy = py - sy, angToSun = Math.atan2(dy, dx);
            context.save();
            context.translate(px, py);
            var pGrad = context.createRadialGradient(-moon.sz*0.3, -moon.sz*0.3, 0, 0, 0, moon.sz);
            pGrad.addColorStop(0, moon.col); pGrad.addColorStop(1, "#000000");
            context.beginPath(); context.arc(0, 0, moon.sz, 0, 7); context.fillStyle = pGrad; context.fill();
            context.clip();
            context.fillStyle = "rgba(30, 41, 59, 0.4)";
            for(var i=0; i<6; i++) { context.beginPath(); context.ellipse(Math.sin(i)*20, Math.cos(i)*15, 25, 15, i, 0, 7); context.fill(); }
            context.restore();
            var shad = context.createRadialGradient(px + Math.cos(angToSun)*moon.sz*0.5, py + Math.sin(angToSun)*moon.sz*0.5, 0, px, py, moon.sz);
            shad.addColorStop(0, "rgba(0,0,0,0)"); shad.addColorStop(1, "rgba(0,0,0,0.95)");
            context.beginPath(); context.arc(px, py, moon.sz + 0.5, 0, 7); context.fillStyle = shad; context.fill();
        }

        function drawRealisticSaturn(sx, sy, ex, ey, dt, t) {
            saturn.ang += saturn.spd * dt * 0.1;
            var px = ex + Math.cos(saturn.ang) * saturn.dist;
            var py = ey + Math.sin(saturn.ang) * saturn.dist * 0.65;
            var dx = px - sx, dy = py - sy, angToSun = Math.atan2(dy, dx);
            context.save();
            context.translate(px, py);
            context.globalAlpha = 0.6;
            for(var r=0; r<10; r++) {
                context.beginPath(); context.ellipse(0, 0, saturn.sz*(1.8+r*0.1), saturn.sz*(0.6+r*0.03), 0.4, 0, 7);
                context.strokeStyle = (r === 4) ? "rgba(0,0,0,0.5)" : "rgba(216, 174, 141, 0.2)";
                context.lineWidth = 3; context.stroke();
            }
            context.globalAlpha = 1.0;
            var pGrad = context.createRadialGradient(-saturn.sz*0.3, -saturn.sz*0.3, 0, 0, 0, saturn.sz);
            pGrad.addColorStop(0, saturn.col); pGrad.addColorStop(1, "#1a0f08");
            context.beginPath(); context.arc(0, 0, saturn.sz, 0, 7); context.fillStyle = pGrad; context.fill();
            context.restore();
            var shad = context.createRadialGradient(px + Math.cos(angToSun)*saturn.sz*0.5, py + Math.sin(angToSun)*saturn.sz*0.5, 0, px, py, saturn.sz);
            shad.addColorStop(0, "rgba(0,0,0,0)"); shad.addColorStop(1, "rgba(0,0,0,0.9)");
            context.beginPath(); context.arc(px, py, saturn.sz + 0.5, 0, 7); context.fillStyle = shad; context.fill();
        }

        function drawPlanet(p, ex, ey, sx, sy, dt, t) {
            p.ang += p.spd * dt * 0.1;
            var px = ex + Math.cos(p.ang) * p.dist;
            var py = ey + Math.sin(p.ang) * p.dist * 0.7;
            var dx = px - sx, dy = py - sy, angToSun = Math.atan2(dy, dx);
            context.save();
            context.translate(px, py);
            var pGrad = context.createRadialGradient(-p.sz*0.3, -p.sz*0.3, 0, 0, 0, p.sz);
            pGrad.addColorStop(0, p.col); pGrad.addColorStop(1, "#000000");
            context.beginPath(); context.arc(0, 0, p.sz, 0, 7); context.fillStyle = pGrad; context.fill();
            context.restore();
            var shad = context.createRadialGradient(px + Math.cos(angToSun)*p.sz*0.5, py + Math.sin(angToSun)*p.sz*0.5, 0, px, py, p.sz);
            shad.addColorStop(0, "rgba(0,0,0,0)"); shad.addColorStop(1, "rgba(0,0,0,0.9)");
            context.beginPath(); context.arc(px, py, p.sz + 0.5, 0, 7); context.fillStyle = shad; context.fill();
        }

        function updateComets() {
            if (Math.random() > 0.996) {
                var s = Math.floor(Math.random()*4), cx, cy, cvx, cvy;
                if(s==0){cx=Math.random()*w; cy=-50; cvx=(Math.random()-0.5)*10; cvy=8+Math.random()*8;}
                else if(s==1){cx=Math.random()*w; cy=h+50; cvx=(Math.random()-0.5)*10; cvy=-(8+Math.random()*8);}
                else if(s==2){cx=-50; cy=Math.random()*h; cvx=8+Math.random()*8; cvy=(Math.random()-0.5)*10;}
                else{cx=w+50; cy=Math.random()*h; cvx=-(8+Math.random()*8); cvy=(Math.random()-0.5)*10;}
                comets.push({ x: cx, y: cy, vx: cvx, vy: cvy, life: 1 });
            }
            for (var i = 0; i < comets.length; i++) {
                var c = comets[i];
                var g = context.createLinearGradient(c.x, c.y, c.x - c.vx*12, c.y - c.vy*12);
                g.addColorStop(0, "white"); g.addColorStop(1, "transparent");
                context.strokeStyle = g; context.lineWidth = 4; context.beginPath();
                context.moveTo(c.x, c.y); context.lineTo(c.x - c.vx*15, c.y - c.vy*15); context.stroke();
                c.x += c.vx; c.y += c.vy; c.life -= 0.008;
                if(c.life <= 0) { comets.splice(i, 1); i--; }
            }
        }

        function startSimulation() {
            setInterval(function() {
                var now = new Date(), start = new Date(now.getFullYear(), now.getMonth(), now.getDate()).getTime();
                var elapsed = (Date.now() - start) / 1000;
                document.getElementById('birthCount').innerText = Math.floor(elapsed * BIRTH_RATE).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
                document.getElementById('clock').innerText = now.toLocaleTimeString('en-GB');
                document.getElementById('bar').style.width = (elapsed / 86400 * 100) + "%";
                if (worldGeo) {
                    var keys = Object.keys(featureIndex);
                    flashingISO[keys[Math.floor(Math.random()*keys.length)]] = Date.now();
                }
            }, 1000 / BIRTH_RATE);
        }

        var field = document.getElementById('starfield');
        for (var i = 0; i < 60; i++) {
            var s = document.createElement('div'); s.className = 'star';
            s.style.width = s.style.height = (1 + Math.random()*2) + 'px';
            s.style.left = Math.random()*100 + '%'; s.style.top = Math.random()*100 + '%';
            s.style.setProperty('--t', (2 + Math.random()*3) + 's');
            field.appendChild(s);
        }

        window.onresize = setSizes;
        init();
    </script>
</body>
</html>